(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{941:function(e,t,n){"use strict";n.r(t),n.d(t,"NoteList",(function(){return I}));var a=n(2),o=n.n(a),s=n(0),l=n.n(s),r=n(846),i=n(7),c=n.n(i),h=n(147),d=n(157),p=()=>{var e=Object(h.d)(e=>e.ui.hasLoadedNotes),t=Object(h.d)(e=>e.ui.searchQuery),n=Object(h.c)();return l.a.createElement("div",{className:"note-list-placeholder theme-color-fg"},e?t.length?"No Results":"No Notes":"Loading Notes",e&&(t.length?l.a.createElement("button",{onClick:()=>n(d.a.ui.createNote({content:t}))},'Create a new note titled "',t,'"'):l.a.createElement("button",{onClick:()=>n(d.a.ui.createNote())},"Create a new note")))};function u(){return l.a.createElement("svg",{className:"icon-published-small",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},l.a.createElement("rect",{x:"0",fill:"none",width:"16",height:"16"}),l.a.createElement("g",null,l.a.createElement("polygon",{points:"7.38 10.25 5.13 8.11 6.16 7.02 7.36 8.17 9.82 5.75 10.87 6.82 7.38 10.25"}),l.a.createElement("path",{d:"M13,.93H3a1.5,1.5,0,0,0-1.5,1.5V12.57A1.5,1.5,0,0,0,3,14.07H13a1.5,1.5,0,0,0,1.5-1.5V2.43A1.5,1.5,0,0,0,13,.93ZM3.5,12.07V4h9v8.07Z"})))}function m(){return l.a.createElement("svg",{className:"icon-pinned-small",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},l.a.createElement("rect",{x:"0",fill:"none",width:"16",height:"16"}),l.a.createElement("g",null,l.a.createElement("path",{d:"M4.41,10.17l-4-4,5.65-.52L8.65,3.1,7.24,1.69,8.66.27l7.07,7.07L14.31,8.76,12.89,7.33,10.33,9.91l-.52,5.66-4-4L3,14.41,1.59,13Zm3.8,1L8.4,9l3.07-3.1-1.4-1.41L7,7.6l-2.13.19Z"})))}function g(){return l.a.createElement("svg",{className:"icon-sync-small",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},l.a.createElement("rect",{x:"0",fill:"none",width:"16",height:"16"}),l.a.createElement("g",null,l.a.createElement("path",{d:"M14,2v5h-0.09h-2.05H9l1.82-1.82C10.1,4.46,9.11,4,8,4C6.14,4,4.59,5.28,4.14,7H2.09C2.57,4.17,5.03,2,8,2 c1.65,0,3.14,0.69,4.22,1.78L14,2z M8,12c-1.11,0-2.1-0.46-2.82-1.18L7,9H4.14H2.09H2v5l1.78-1.78C4.86,13.31,6.35,14,8,14 c2.97,0,5.43-2.17,5.91-5h-2.05C11.41,10.72,9.86,12,8,12z"})))}var w=n(6),y=n(561),v=n.n(y),N=n(210),b=(e,t)=>e.length>0&&t.length>0?e.reduce((e,t)=>{var{filter:n,replacer:a}=t,o="string"==typeof n&&Object(N.b)(n),s=o&&o.length>0?new RegExp(Object(w.escapeRegExp)(o),"gi"):n;return v()(e,s,a)},t).map((e,t)=>e&&"string"!=typeof e?l.a.cloneElement(e,{key:t}):e):t,E=e=>({filter:e,replacer:e=>{if(e.length)return l.a.createElement("span",{className:"search-match"},e)}}),f=n(231),O=n(251),x=n(193);class C extends s.Component{constructor(e){super(e),o()(this,"createdAt",void 0),o()(this,"updateScheduled",void 0),this.createdAt=Date.now()}componentDidUpdate(e){var t,n;(null===(t=e.note)||void 0===t?void 0:t.content)!==(null===(n=this.props.note)||void 0===n?void 0:n.content)&&this.props.invalidateHeight(),this.props.lastUpdated<1e3&&!this.updateScheduled&&(this.updateScheduled=setTimeout(()=>this.forceUpdate(),1e3))}componentWillUnmount(){clearTimeout(this.updateScheduled)}render(){var{displayMode:e,hasPendingChanges:t,isOffline:n,isOpened:a,lastUpdated:o,noteId:s,note:r,openNote:i,pinNote:h,searchQuery:d,style:p}=this.props;if(!r)return l.a.createElement("div",null,"Couldn't find note");var{title:w,preview:y}=Object(f.c)(r,d),v=r.systemTags.includes("pinned"),x=!!r.publishURL,C=o-this.createdAt>1e3&&Date.now()-o<1200,j=c()("note-list-item",{"note-list-item-selected":a,"note-list-item-pinned":v,"note-recently-updated":C,"published-note":x}),k=c()("note-list-item-pinner",{"note-list-item-pinned":v}),D=Object(N.a)(d).map(E);return l.a.createElement("div",{style:p,className:j},l.a.createElement("div",{className:"note-list-item-status"},l.a.createElement("div",{className:k,tabIndex:0,onClick:()=>h(s,!v)},l.a.createElement(m,null))),l.a.createElement("div",{className:"note-list-item-text theme-color-border",tabIndex:0,onClick:()=>i(s)},l.a.createElement("div",{className:"note-list-item-title"},l.a.createElement("span",null,b(D,Object(O.a)(w)))),"expanded"===e&&y.length>0&&l.a.createElement("div",{className:"note-list-item-excerpt theme-color-fg-dim"},Object(O.a)(y).split("\n").map((e,t)=>l.a.createElement(l.a.Fragment,{key:t},t>0&&l.a.createElement("br",null),b(D,e.slice(0,200))))),"comfy"===e&&y.length>0&&l.a.createElement("div",{className:"note-list-item-excerpt theme-color-fg-dim"},b(D,Object(O.a)(y).slice(0,200)))),l.a.createElement("div",{className:"note-list-item-status-right theme-color-border"},t&&l.a.createElement("span",{className:c()("note-list-item-pending-changes",{"is-offline":n})},l.a.createElement(g,null)),x&&l.a.createElement("span",{className:"note-list-item-published-icon"},l.a.createElement(u,null))))}}var j={openNote:d.a.ui.openNote,pinNote:d.a.data.pinNote},k=Object(h.b)((e,t)=>{var n,{noteId:a}=t;return{displayMode:e.settings.noteDisplay,hasPendingChanges:x.c(e,a),isOffline:"offline"===e.simperium.connectionStatus,isOpened:e.ui.openedNote===a,lastUpdated:null!==(n=e.simperium.lastRemoteUpdate.get(a))&&void 0!==n?n:-1/0,note:e.data.notes.get(a),searchQuery:e.ui.searchQuery}},j)(C),D=n(391);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class I extends s.Component{constructor(){super(...arguments),o()(this,"state",{heightCache:new r.c({defaultHeight:135,fixedWidth:!0,keyMapper:e=>{var{filteredNotes:t,searchQuery:n,tagResultsFound:a}=this.props;return 0===a&&0===t.length?"no-notes":0===n.length||0===a?t[e]:0===e?"tag-suggestions":1===e?"notes-header":t[e-2]}}),lastNoteDisplay:null,windowWidth:null}),o()(this,"list",Object(s.createRef)()),o()(this,"handleShortcut",e=>{if(this.props.keyboardShortcuts){var{ctrlKey:t,metaKey:n,shiftKey:a}=e,o=e.key.toLowerCase(),{isSmallScreen:s,showNoteList:l}=this.props,r=t||n;return r&&a&&"k"===o?(this.props.selectNoteAbove(),e.stopPropagation(),e.preventDefault(),!1):r&&a&&"j"===o?(this.props.selectNoteBelow(),e.stopPropagation(),e.preventDefault(),!1):s&&r&&a&&"l"===o?(this.props.toggleNoteList(),e.stopPropagation(),e.preventDefault(),!1):!s||!l||"Enter"!==o||(this.props.openNote(),e.stopPropagation(),e.preventDefault(),!1)}}),o()(this,"toggleShortcuts",e=>{e?window.addEventListener("keydown",this.handleShortcut,!0):window.removeEventListener("keydown",this.handleShortcut,!0)})}componentDidMount(){this.toggleShortcuts(!0)}componentWillUnmount(){this.toggleShortcuts(!1)}render(){var{filteredNotes:e,noteDisplay:t,onEmptyTrash:n,openedNote:a,searchQuery:o,showTrash:i,tagResultsFound:h}=this.props,{heightCache:d}=this.state,u=((e,t,n)=>0===t.length||0===n?e:["tag-suggestions","notes-header",...e.length>0?e:["no-notes"]])(e,o,h),m=u.findIndex(e=>e===a),g=((e,t)=>{var{heightCache:n}=t;return t=>{var{index:a,key:o,parent:s,style:i}=t,c=e[a];return"no-notes"===c?l.a.createElement(r.b,{cache:n,columnIndex:0,key:"no-notes",parent:s,rowIndex:a},l.a.createElement("div",{className:"note-list is-empty",style:L(L({},i),{},{height:200})},l.a.createElement("span",{className:"note-list-placeholder theme-color-fg"},"No Notes"))):"tag-suggestions"===c||"notes-header"===c?"tag-suggestions"===c?l.a.createElement(r.b,{cache:n,columnIndex:0,key:"tag-suggestions",parent:s,rowIndex:a},l.a.createElement(D.a,{style:L({},i)})):l.a.createElement(r.b,{cache:n,columnIndex:0,key:"notes-header",parent:s,rowIndex:a},l.a.createElement("div",{className:"note-list-header",style:L({},i)},"Notes")):l.a.createElement(r.b,{cache:n,columnIndex:0,key:o,parent:s,rowIndex:a},l.a.createElement(k,{invalidateHeight:()=>n.clear(a,0),noteId:c,style:i}))}})(u,{heightCache:d}),w=0===u.length,y=l.a.createElement("div",{className:"note-list-empty-trash theme-color-border"},l.a.createElement("button",{type:"button",className:"button button-borderless button-danger",onClick:n},"Empty Trash"));return l.a.createElement("div",{className:c()("note-list",{"is-empty":w})},w?l.a.createElement(p,null):l.a.createElement(s.Fragment,null,l.a.createElement("div",{className:"note-list-items ".concat(t)},l.a.createElement(r.a,null,e=>{var{height:n,width:a}=e;return l.a.createElement(r.d,{ref:this.list,estimatedRowSize:126,height:n,noteDisplay:t,notes:u,rowCount:u.length,rowHeight:d.rowHeight,rowRenderer:g,scrollToIndex:m,width:a})})),i&&y))}}o()(I,"displayName","NoteList"),o()(I,"getDerivedStateFromProps",(e,t)=>(t.heightCache.clear(0),t.heightCache.clear(1),t.heightCache.clear(2),e.noteDisplay!==t.lastNoteDisplay||e.windowWidth!==t.windowWidth?(t.heightCache.clearAll(),{lastNoteDisplay:e.noteDisplay,windowWidth:e.windowWidth}):null));var P={onEmptyTrash:d.a.ui.emptyTrash,openNote:d.a.ui.openNote,selectNoteAbove:d.a.ui.selectNoteAbove,selectNoteBelow:d.a.ui.selectNoteBelow,toggleNoteList:d.a.ui.toggleNoteList};t.default=Object(h.b)(e=>({isSmallScreen:x.b(e),keyboardShortcuts:e.settings.keyboardShortcuts,noteDisplay:e.settings.noteDisplay,filteredNotes:e.ui.filteredNotes,openedNote:e.ui.openedNote,openedTag:e.ui.openedTag,searchQuery:e.ui.searchQuery,showNoteList:e.ui.showNoteList,showTrash:e.ui.showTrash,tagResultsFound:e.ui.tagSuggestions.length,windowWidth:e.browser.windowWidth}),P)(I)}}]);